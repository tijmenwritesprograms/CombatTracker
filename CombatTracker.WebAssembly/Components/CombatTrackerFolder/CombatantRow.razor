
<tr class="@RowClass slide-in">
    <td>
        <InitiativeIndicator IsCurrentTurn="@IsCurrentTurn" />
    </td>
    <td>
        <InitiativeDisplay Initiative="@Instance.Initiative" />
    </td>
    <td class="@TextClass">
        @if (!Data.IsCharacter)
        {
            <MonsterNameDisplay 
                Name="@Data.Name"
                ReferenceId="@Data.ReferenceId"
                CombatantIndex="@Instance.Index"
                IsExpanded="@IsQuickRefExpanded"
                OnShowStatblock="@OnShowStatblock"
                OnToggleQuickReference="@OnToggleQuickReference" />
        }
        else
        {
            <strong>@Data.Name</strong>
        }
    </td>
    <td class="@TextClass">@Data.Type</td>
    <td>
        <HpDisplay 
            HpCurrent="@Instance.HpCurrent"
            HpMax="@Data.HpMax"
            Status="@Instance.Status" />
    </td>
    <td class="@TextClass">
        <ArmorClassDisplay ArmorClass="@Data.AC" />
    </td>
    <td>
        <StatusBadge Status="@Instance.Status" />
    </td>
    <td>
        <CombatantActions 
            CombatantIndex="@Instance.Index" 
            IsAlive="@(Instance.Status == Status.Alive)" 
            OnDamage="@OnDamage" 
            OnHeal="@OnHeal" />
    </td>
</tr>

@code {
    [Parameter, EditorRequired]
    public CombatantInstance Instance { get; set; } = null!;

    [Parameter, EditorRequired]
    public CombatantSetupData Data { get; set; } = null!;

    [Parameter, EditorRequired]
    public bool IsCurrentTurn { get; set; }

    [Parameter]
    public bool IsQuickRefExpanded { get; set; }

    [Parameter, EditorRequired]
    public EventCallback<int> OnDamage { get; set; }

    [Parameter, EditorRequired]
    public EventCallback<int> OnHeal { get; set; }

    [Parameter, EditorRequired]
    public EventCallback<int> OnShowStatblock { get; set; }

    [Parameter, EditorRequired]
    public EventCallback<int> OnToggleQuickReference { get; set; }

    private string RowClass => IsCurrentTurn ? "table-primary" : "";
    private string TextClass => Instance.Status != Status.Alive ? "text-decoration-line-through text-muted" : "";
}
