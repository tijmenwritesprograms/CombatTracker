<div class="mobile-combatant-content">
    <div class="mobile-combatant-header">
        <div class="d-flex align-items-center gap-2 mb-2">
            <InitiativeIndicator IsCurrentTurn="@IsCurrentTurn" />
            <div class="initiative-badge">
                <InitiativeDisplay Initiative="@Instance.Initiative" />
            </div>
            <div class="flex-grow-1">
                @if (!Data.IsCharacter)
                {
                    <MonsterNameDisplay 
                        Name="@Data.Name"
                        ReferenceId="@Data.ReferenceId"
                        CombatantIndex="@Instance.Index"
                        IsExpanded="@IsQuickRefExpanded"
                        OnShowStatblock="@OnShowStatblock"
                        OnToggleQuickReference="@OnToggleQuickReference" />
                }
                else
                {
                    <strong class="@TextClass">@Data.Name</strong>
                }
            </div>
        </div>
        <div class="mobile-combatant-type @TextClass">
            @Data.Type
        </div>
    </div>

    <div class="mobile-combatant-stats">
        <div class="stat-item">
            <div class="stat-label">HP</div>
            <div class="stat-value">
                <HpDisplay 
                    HpCurrent="@Instance.HpCurrent"
                    HpMax="@Data.HpMax"
                    Status="@Instance.Status" />
            </div>
        </div>
        <div class="stat-item">
            <div class="stat-label">AC</div>
            <div class="stat-value @TextClass">
                <ArmorClassDisplay ArmorClass="@Data.AC" />
            </div>
        </div>
        <div class="stat-item">
            <div class="stat-label">Status</div>
            <div class="stat-value">
                <StatusBadge Status="@Instance.Status" />
            </div>
        </div>
    </div>

    <div class="mobile-combatant-actions">
        <CombatantActions 
            CombatantIndex="@Instance.Index" 
            IsAlive="@(Instance.Status == Status.Alive)" 
            OnDamage="@OnDamage" 
            OnHeal="@OnHeal" />
    </div>
</div>

@code {
    [Parameter, EditorRequired]
    public CombatantInstance Instance { get; set; } = null!;

    [Parameter, EditorRequired]
    public CombatantSetupData Data { get; set; } = null!;

    [Parameter, EditorRequired]
    public bool IsCurrentTurn { get; set; }

    [Parameter]
    public bool IsQuickRefExpanded { get; set; }

    [Parameter, EditorRequired]
    public EventCallback<int> OnDamage { get; set; }

    [Parameter, EditorRequired]
    public EventCallback<int> OnHeal { get; set; }

    [Parameter, EditorRequired]
    public EventCallback<int> OnShowStatblock { get; set; }

    [Parameter, EditorRequired]
    public EventCallback<int> OnToggleQuickReference { get; set; }

    private string TextClass => Instance.Status != Status.Alive ? "text-decoration-line-through text-muted" : "";
}
